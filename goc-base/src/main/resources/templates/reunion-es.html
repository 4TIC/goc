<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta th:charset="${charset}" />
    <title>Acta gestión organos colegiados</title>
    <link rel="stylesheet" type="text/css" href="/goc/css/jquery.modal.css" />
    <link rel="stylesheet" type="text/css" href="/goc/css/style.css" />
    <link th:if="${customCSS != ''}" rel="stylesheet" type="text/css" th:href="${customCSS}" />

    <script src="/goc/js/jquery.min.js"></script>
    <script src="/goc/js/jquery.modal.js"></script>
    <script th:inline="javascript">
    /*<![CDATA[*/
        var applang = [[${applang}]];
    /*]]>*/
    </script>
  </head>
  <body>
    <div class="content">
      <div class="header">
        <img class="logo" src="#" th:src="${logo}" />
        <h1>Gestión de órganos colegiados</h1>
        <div class="topmenu">
          <ul th:if="${alternativeLanguage and alternativeLanguage != ''}">
            <li><a th:href="${'?lang=' + mainLanguage}" th:text="${mainLanguageDescription}">Español</a></li>
            <li><a th:href="${'?lang=' + alternativeLanguage}" th:text="${alternativeLanguageDescription}">Valencià</a></li>
          </ul>
        </div>
      </div>

      <h1 style="clear:both;" th:text="'Reunión: ' + ${reunion.asunto}">Título reunión</h1>
      <h2>Información básica</h2>
      <ul>
        <li th:utext="'&lt;strong&gt;Fecha&lt;/strong&gt;: ' + ${#dates.format(reunion.fecha, 'dd/MM/YYYY HH:mm')}"></li>
        <li th:if="${reunion.fechaSegundaConvocatoria}" th:utext="'&lt;strong&gt;Segunda convocatoria&lt;/strong&gt;: ' + ${#dates.format(reunion.fechaSegundaConvocatoria, 'dd/MM/YYYY HH:mm')}"></li>
        <li th:if="${reunion.responsableActa}" th:utext="'&lt;strong&gt;Responsable de acta&lt;/strong&gt;: ' + ${reunion.responsableActa}"></li>
        <li th:if="${reunion.numeroSesion} != null" th:utext="'&lt;strong&gt;Número de sesión&lt;/strong&gt;: ' + ${reunion.numeroSesion}"></li>
        <li th:if="${reunion.ubicacion}" th:utext="'&lt;strong&gt;Lugar&lt;/strong&gt;: ' + ${reunion.ubicacion}"></li>
        <li th:utext="'&lt;strong&gt;Duración&lt;/strong&gt;: ' + ${reunion.duracion} + ' minutos'"></li>
        <li th:if="${reunion.descripcion}" th:utext="'&lt;strong&gt;Descripción&lt;/strong&gt;: ' + ${reunion.descripcion}"></li>
        <li th:if="${reunion.acuerdos != null}" th:utext="'&lt;strong&gt;Acuerdos&lt;/strong&gt;: ' + ${reunion.acuerdos}"></li>
        <li th:if="${reunion.urlGrabacion != null}"><strong>URL grabación</strong>: <a th:href="${reunion.urlGrabacion}" th:text="${reunion.urlGrabacion}"></a></li>
        <li th:if="${reunion.telematica}"><strong>Reunión telemática. Instrucciones</strong>: <span th:text="${reunion.telematicaDescripcion}"></span></li>
      </ul>
      <h2 th:if="${not #lists.isEmpty(reunion.organos)}">Organos y asistentes</h2>
      <ul th:if="${not #lists.isEmpty(reunion.organos)}">
        <li th:each="organo : ${reunion.organos}">
          <h3 th:text="${organo.nombre}">Organo asistente</h3>
          <ul th:with="miembros=${organo.asistentes}">
            <li th:each="miembro : ${miembros}">
              <div>
                <span th:text="${miembro.cargo.nombre} + ' - ' + ${miembro.nombre} + ' (' + ${miembro.email} + ')'">Miembro</span>
                <span th:if="${miembro.suplente}" th:text="'[Assisteix com a suplent ' + ${miembro.suplente} + ']'">Suplente</span>
                <strong th:if="${miembro.asistenciaConfirmada}">Asistirá</strong>
                <strong th:if="${miembro.asistenciaConfirmada == false}">No asistirá</strong>
              </div>
              <div class="confirmacion" th:if="${reunion.completada != true and (connectedUserId == miembro.miembroId or (miembro.suplenteId != null and connectedUserId == miembro.suplenteId))}">
                <strong>Confirma asistencia:</strong>
                <button th:class="${miembro.asistenciaConfirmada == true } ? activo : inactivo" name="confirmar">Sí</button>
                <button th:class="${miembro.asistenciaConfirmada == false} ? activo : inactivo" name="denegar">No</button>
                <button th:attr="data-miembroid=${miembro.id}, data-suplente=${miembro.suplente}" th:if="${reunion.admiteSuplencia and (connectedUserId == miembro.miembroId or miembro.suplenteId != null and connectedUserId == miembro.suplenteId)}" name="suplente">Gestionar suplente</button>
              </div>
            </li>
          </ul>
        </li>
      </ul>
      <h2 th:if="${not #lists.isEmpty(reunion.documentos)}">Documentación</h2>
      <ul th:if="${not #lists.isEmpty(reunion.documentos)}">
        <li th:each="documento : ${reunion.documentos}"><a th:href="'/goc/rest/reuniones/' + ${reunion.id} + '/documentos/' + ${documento.id} + '/descargar'" th:text="${documento.descripcion}">Descripción documento</a></li>
      </ul>
      <h2 th:if="${not #lists.isEmpty(reunion.puntosOrdenDia)}">Puntos del orden del día</h2>
      <ol th:if="${not #lists.isEmpty(reunion.puntosOrdenDia)}">
        <li th:each="puntoOrdenDia : ${reunion.puntosOrdenDia}">
          <span th:text="${puntoOrdenDia.titulo}"></span>
          <div th:if="${puntoOrdenDia.descripcion} != null" th:text="'Descripció: ' + ${puntoOrdenDia.descripcion}"></div>
          <div th:if="${puntoOrdenDia.deliberaciones} != null" th:text="'Deliberacions: ' + ${puntoOrdenDia.deliberaciones}"></div>
          <div th:if="${puntoOrdenDia.acuerdos} != null" th:text="'Acords: ' + ${puntoOrdenDia.acuerdos}"></div>
          <span th:if="${not #lists.isEmpty(puntoOrdenDia.documentos)}">Documentació:</span>
          <ul th:with="documentos=${puntoOrdenDia.documentos}">
            <li th:each="documento : ${documentos}"><a th:href="'/goc/rest/reuniones/' + ${reunion.id} + '/puntosOrdenDia/' + ${puntoOrdenDia.id} + '/documentos/' + ${documento.id} + '/descargar'" th:text="${documento.descripcion}">Descripcion documento</a></li>
          </ul>
          <span th:if="${not #lists.isEmpty(puntoOrdenDia.documentosAcuerdos)}">Acords:</span>
          <ul th:with="acuerdos=${puntoOrdenDia.documentosAcuerdos}">
            <li th:each="acuerdo : ${acuerdos}"><a th:href="'/goc/rest/reuniones/' + ${acuerdo.id} + '/puntosOrdenDia/' + ${puntoOrdenDia.id} + '/acuerdos/' + ${acuerdo.id} + '/descargar'" th:text="${acuerdo.descripcion}">Descripcion acuerdo</a></li>
          </ul>
          <br />
        </li>
      </ol>

      <h3>Convocante: <span style="font-weight: normal; font-size: 16px;" th:text="${reunion.creadorNombre} + '(' + ${reunion.creadorEmail} + ')'">Info convocante</span></h3>
      <div class="nuevo-suplente" style="display: none;">
        <input type="hidden" name="organoMiembroId" />
        <p class="suplente-actual">Suplente actual: <strong></strong> <button name="borra-suplente">Borrar suplente</button></p>
        <p>Añadir un suplente:</p>
        <div class="header">
          <input type="text" name="query-persona" /><button name="busca-persona">Buscar</button>
        </div>
        <ul class="resultados">
        </ul>
        <div class="footer">
          <button name="add-suplente">Añadir suplente</button>
        </div>
      </div>

      <div class="nuevo-comentario" style="display: none;">
        <p>Añadir un comentario:</p>
        <input type="hidden" name="reunionId" th:value="${reunion.id}" />
        <textarea style="width: 100%; height: 240px;"></textarea>
        <button class="post-comentario">Añadir</button>
      </div>
      <br style="margin-top: 2em;"/>
      <button th:if="${ not reunion.completada and reunion.admiteComentarios and permitirComentarios}"   class="add-comentario">Añadir un comentario</button>
      <div th:if="${permitirComentarios}" class="comentarios"></div>
    </div>
    <script src="/goc/js/script.js"></script>
  </body>
</html>
